modules:

  macro:

    - key: ec2u-phds-macro
      title: EC2U PhD Agreements Tool
      description: AI-powered Confluence macro for drafting EC2U cotutelle PhD agreements.

      resource: macro
      render: native
      layout: block

      resolver:

        function: resolver

  consumer:

    - key: ec2u-phds-consumer
      queue: executor-queue
      resolver:
        function: executor
        method: execute

  function:

    - key: resolver
      handler: server/ports/index.handler

    - key: executor
      handler: server/tasks/index.handler
      timeoutSeconds: 600

resources:

  - key: macro
    path: src/client/macro.tsx

app:

  id: ari:cloud:ecosystem::app/68e73326-bb04-4df2-a14c-382ba3abbe2b
  runtime:
    name: nodejs22.x

permissions:

  scopes:
    - read:confluence-content.all
    - write:confluence-file
    - read:attachment:confluence
    - delete:attachment:confluence
    - storage:app

remotes:

  - key: gemini
    baseUrl: https://generativelanguage.googleapis.com
    operations:
      - fetch

  - key: langfuse
    baseUrl: https://cloud.langfuse.com
    operations:
      - fetch
